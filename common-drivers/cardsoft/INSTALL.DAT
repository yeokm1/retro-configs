/*
 *      SystemSoft Corporation
 *      313 Speen Street
 *      Natick, MA 01760
 *      (508) 651-0088
 *
 *      Copyright 1993-1994 SystemSoft Corporation.  All Rights Reserved.
 *
 * ------------------------------------------------------------------------
 * --   Install DAT file for SystemSoft CardSoft(TM) Software            --
 * ------------------------------------------------------------------------
 *
 * ------------------------------------
 * --   Version 2.14.04 (05/04/94)   --
 * --   Project # 2182  (Generic)    --
 * --   Last release by PJS          --
 * ------------------------------------
 */

@DefineProject
    @name = "CardSoft(TM) 3.1"
    @Version = "1"
    @OutDrive = C
    @SubDir = "CardSoft"
    @immediate = 1
@EndProject

/*
 * TRANSLATE TEXT BETWEEN THIS COMMENT AND THE ONE FOLLOW
 * THE @DEFINEVARS BLOCK.
 *
 * DO NOT CHANGE ANY WORDS WHICH ARE PREPENDED WITH AN '@'.
 *
 * PLEASE TRY TO MAINTAIN WHITE SPACE AS IT IS.
 */

@definevars
@qstring @name2 = "CardSoft"
@qstring @sversion = "Version 2.14 (2182)"
@qstring @ver = "3.1"
@qstring @sourcedir = "cardsoft"
@qstring @toolsdir = "cs_tools"
@qstring @company = "SystemSoft Corporation"
@qstring @title   = "@name Install Utility"
@qstring @title2  = "@name De-Installation Procedure"
@qstring @ss365sl = "Intel 82365SL Socket Services"
@qstring @ss365lp = "Intel 82365LP Socket Services"
@qstring @ssdatabook = "DataBook Socket Services"
@qstring @ss6941 = "ASCII 6941 Socket Services"
@qstring @ss6942 = "ASCII 6942 Socket Services"
@qstring @sscirrus = "Cirrus Socket Services"
@qstring @ssvadem = "Vadem Socket Services"
@qstring @ssvlsi = "VLSI Socket Services"
@qstring @ssibm720 = "IBM 720 Socket Services"
@qstring @ssppec = "Intel PPEC Socket Services"
@qstring @ssnone = "Do Not Install Socket Services"
@qstring @365sl = "Intel 82365SL"
@qstring @365lp = "Intel 82365LP"
@qstring @databook = "DataBook"
@qstring @6941 = "ASCII 6941"
@qstring @6942 = "ASCII 6942"
@qstring @cirrus = "Cirrus"
@qstring @vadem = "Vadem"
@qstring @vlsi = "VLSI"
@qstring @ibm720 = "IBM 720"
@qstring @ppec = "Intel PPEC"
@qstring @socketservices = "Socket Services"
@qstring @cardservices = "Card Services"
@qstring @csalloc = "Card Services Allocation Utility"
@qstring @csallocini = "Card Services Utility Initialization File"
@qstring @sramdrv = "Static RAM Card Driver"
@qstring @memdrv = "Static RAM Card and Flash Card Driver"
@qstring @msflash = "Flash File System"
@qstring @dblflash = "Double Flash File System"
@qstring @mtaa = "MTD - AMD Type A Flash"
@qstring @mtab = "MTD - AMD Type B Flash"
@qstring @mti1 = "MTD - Intel Series 1 Flash"
@qstring @mti2p = "MTD - Intel Series 2 and 2+ Flash"
@qstring @mtsram = "MTD - SRAM Cards"
@qstring @mtd = "MTD Drive - required for any MTD support"
@qstring @memcard = "Flash File System Formatting Utility"
@qstring @atadrv = "ATA Card Driver"
@qstring @atainit = "ATA Card Formatting Utility"
@qstring @cardid = "CardID - Client Driver"
@qstring @cardlib = "CardID - PCMCIA Card Library"
@qstring @cardidini = "CardID - Initialization File"
@qstring @cardinfo = "Card Information Utility"
@qstring @config = "@name Configuration Utility"
@qstring @csapm = "CS_APM - Power Management Driver"
@qstring @standard  = "Standard Installation"
@qstring @custom    = "Custom Installation"
@qstring @deinstall = "De-Installation"
@qstring @continue  = "Continue Anyway"
@qstring @changedir = "Change Destination Directory"
@qstring @firsttime = "First Time Install"
@qstring @upgrade   = "Upgrade"
@qstring @giveup    = "Exit"
@qstring @noboot = "Exit to DOS"
@qstring @dossubdir = "DOS"
@qstring @rem = "REM"
@qstring @describe1 = "
    While using INSTALL:
       - Menu selections are changed with the Up/Down Arrow keys.
       - Menu items with a YES or NO, are toggled with the <Space Bar>.
       - The <Enter> key is used to complete your Menu selection(s).
       - You may quit INSTALL with the <Escape> Key at any time."
@qstring @describe2 = "
    Please Select a Standard or Custom Install.

    The @standard allows you to select the destination drive
    and destination subdirectory.  All software components will be
    loaded and CONFIG.SYS will be updated accordingly.

    The @custom allows you to select the destination drive,
    destination subdirectory, @name2 components you wish to
    install, and updates CONFIG.SYS accordingly."
@qstring @somefilesexist = "
    Some @name2 components already exist in "
@qstring @describe3 = "
    A @standard will overwrite these files.

    Do you wish to continue the @standard as is,
    Change the Destination Directory for the @standard,
    switch to the @custom,
    or exit the Install Utility?"
@qstring @describe4 = "
    Note that a @custom will allow you to specify
    which individual files you wish to install."
@qstring @askupgrade = "
    Please specify if this is a First Time Install, an
    Upgrade to previously installed @name2 Software, or
    a @deinstall of @name2 Software."
@qstring @asknumsockets = "
    Please specify the number of PCMCIA sockets in your computer.
    Refer to your system users guide for this information.
    Press <Escape> to quit."
@qstring @askfordrive = "
    Select the destination drive for installing @name.
    It is recommended to install the software to your primary bootable
    hard drive.  The default drive is @outdrive.
    Press <Escape> to quit."
@qstring @notonfloppy = "You cannot install @name2 onto a floppy drive."
@qstring @askforpath = "
    Enter the full directory pathname for installing @name.
    We recommend you use CARDSOFT for the sub-directory name.

    Press <Escape> once to clear, twice to quit."
@qstring @pathprompt = " Directory Pathname "
@qstring @confirmdestination = "
    Please confirm your destination drive and directory,
    from the selections you just made."  
@qstring @adasearch = "Searching for PCMCIA Adapter - Please Wait . . ."
@qstring @askforcomps = "
    Select the @name components you wish to install.
    It is recommended to load all of the following."
@qstring @askforover = "
    If you wish to over-write these files with the drivers located
    on this floppy, please select YES for each listing.  Selecting
    NO will cause Install to use the pre-existing file." 
@qstring @thesefilesexist = "These @name2 components already exist in"
@qstring @askforconfirm = "
    Press the <Space Bar> to change selections.  Press <Escape> to quit."
@qstring @musthavess0 = "
    The"
@qstring @musthavess1 = "PCMCIA adapter was found in your system."
@qstring @ssnotpresent = "
    The @socketservices file that is required for this PCMCIA adapter
    is not present on the distribution disk.

    If you choose to continue, install will load the rest of the files 
    without @socketservices.  However, your @name2 drivers will
    not function without the proper @socketservices file.
"
@qstring @adanotfound = "
    @title is unable to determine which
    @socketservices is required for your computer.  

    Please consult your system's manual for the type of PCMCIA 
    adapter which is present inside your machine.  Then select the 
    one appropriate @socketservices from the following list.
    Use the arrow keys and <Space Bar> to highlight your selection."
@qstring @runcnfgmess = "
    The @config, CONFIG.EXE, may
    be used to modify @name2 parameters, if necessary.

    To do so, please type CONFIG from the "
@qstring @runcnfgmess2 = " sub-directory
    where the @name2 drivers were just installed.
"
@qstring @runcnfgmess3 = "
    This utility will allow you to customize your @name2
    configuration.  Parameters such as Modem card COM ports,
    LAN card memory ranges, and others can be changed through the
    @config.
"
@qstring @runcsallocmess2 = "
    Please remove all PC Cards present in the system.

    The @csalloc, CSALLOC.EXE,
    is updating the @csallocini.
"
@qstring @csallocdone = "
    @csalloc Completed.
"
@qstring @askmodconfigsys = "
    May @title create/modify your CONFIG.SYS file?
    A backup copy of your current file will be made."
@qstring @askmodconfigsys2 = "
    Please note, choosing YES will cause @title 
    to modify the CONFIG.SYS file on your bootable hard drive.  If 
    you do not wish to have this file changed, choose NO, and
    @title will create a sample CONFIG.SYS in 
    the "
@qstring @askmodconfigsys3 = " sub-directory.  

    IT IS RECOMMENDED TO CHOOSE YES."
@qstring @askdevconfigsys = "
    The following @name2 components already exist in 
    the specified destination directory.  Use <Space Bar> to select 
    which of those you wish to have loaded in your CONFIG.SYS file."
@qstring @saveconfigsys = "
    About to modify your CONFIG.SYS file. 
    Your current CONFIG.SYS file will be copied to CONFIG"
@qstring @deinstalloptions = "
    After the @title2 is complete,
    you can recover your previous configuration of @name2
    software by copying CONFIG"
@qstring @deinstalloptions2 = "to CONFIG.SYS.
    
    Otherwise, you can run the @title 
    to perform a @firsttime of the @name software.
"
@qstring @deinstalldone = "
    The @title2 is complete...

    Please press enter to exit to DOS.  Remember, if you wish
    to re-install the @name2 software at a later time, 
    run the @title.
"
@qstring @changingconfigsys = "
    Modifying your CONFIG.SYS file - Please Wait . . ."
@qstring @changingconfigsys2 = "
    Creating a sample CONFIG.SYS file - Please Wait . . ."
@qstring @changingini = "
    Modifying the CARDID.INI file - Please Wait . . ."
@qstring @toggle = "
    Press the <Space Bar> to toggle between YES and NO.
    Then press <Enter> to continue or press <Escape> to quit."
@qstring @yesorno = "YES or NO?  "  
@qstring @cargrtn = "
"
@qstring @destallintro = "
    You have chosen the @title2.

    This feature will disable all of the @name2 drivers currently 
    loaded on your system.  The @title2
    will modify the @name2 driver lines in your CONFIG.SYS 
    file automatically.  
"
@qstring @deinstallwill = "
    The @title2 will allow you
    to totally remove all @name2 Software from loading.
"
@qstring @nextoption1 = "
    The procedure is now complete . . . 

    To exit to the DOS prompt, please press <Enter>.
    Remember that you must reboot the system in order to 
    activate the @name Software."
@qstring @nextoption2 = "
    After you reboot, run SETUP.EXE found on this diskette
    from within Windows if you would like to install the @name2
    Windows drivers."
@qstring @warning = "
    Warning "
@qstring @cnfgmessage = "
    Configuring special driver parameters - Please Wait . . ."
@qstring @nocnfgparm = "
    Could not configure parameter"
@qstring @memmansearch = "
   Searching for Memory Configuration . . .
"
@qstring @foundemm = "
   The @title has detected the presence of the 
   EMM386 memory manager.  In order for @name2 to 
   function properly, certain ranges of memory need to be excluded
   from this memory manager.  If you wish to ensure proper functionality 
   of the @name2 drivers we suggest you add the switch
   X=D000-DFFF.  After this installation is complete, please edit 
   the line in your CONFIG.SYS file to appear as below
"
@qstring @foundqemm = "
   The @title has detected the presence of the 
   QEMM memory manager.  In order for @name2 to 
   function properly, certain ranges of memory need to be excluded
   from this memory manager.  If you wish to ensure proper functionality 
   of the @name2 drivers we suggest you add the switch
   X=D000-DFFF.  After this installation is complete, please edit 
   the line in your CONFIG.SYS file to appear as below
"
@qstring @foundmax = "
   The @title has detected the presence of the 
   386MAX memory manager.  In order for @name2 to 
   function properly, certain ranges of memory need to be excluded
   from this memory manager.  If you wish to ensure proper functionality 
   of the @name2 drivers we suggest you add the switch
   RAM=D000-DFFF.  After this installation is complete, please edit 
   the line in your CONFIG.SYS file to appear as below
"
@qstring @PCMCIAfound = "
    The @title has detected
    pre-existing PCMCIA software installed on your computer.
    If this software is a version of @title,
    then choose De-Install to remove these drivers from loading."    
@qstring @whatnext1 = "
    However, if this software is another type of PCMCIA software,
    it is recommended to refer to your system's manual for
    instructions on how to remove the drivers."
@qstring @whatnext2 = "
    If you wish to de-install the current software, choose Exit
    and refer to you system manual on how to remove the PCMCIA drivers."
@qstring @ifignore = "
    Note that if you do not de-install the current PCMCIA software before
    installing the software on this diskette, you may encounter 
    configuration issues with the new software."
@qstring @rerun = "
    Now that the @title2 is complete,
    you must reboot and run the @title
    in order to install the @name drivers.
"
@qstring @checksystem = "
    Checking your System Configuration . . ."
@qstring @copytools = "
    Creating Sub-Directory Structure . . ."
@if (@OSMajor > 4)
  @qstring @dev = "DEVICEHIGH"
@else
  @qstring @dev = "DEVICE" 
@endif

@endvars

/*
 * ------------ DO NOT TRANSLATE ANYTHING BEYOND THIS POINT ---------------
 */

/*
 *  PUT UP BANNER SCREEN WITH COMPANY NAME AND PROGRAM TITLE
 */

@display
 @cls
 @movecstr(8,28, ,"@company")
 @movecstr(9,23, ,"@title")
 @movecstr(10,29, ,"@sversion")
 @move(20,3)
 @pause
@enddisplay

/*
 *  ASK USER IF THE INSTALL IS FIRST TIME OR UPGRADE OR DE-INSTALLATION.
 */

@getoption
    @cls
@askupgrade
@deinstallwill
    @localwindow (12,40)
    @option 7 = "@firsttime"
    @option 8 = "@upgrade"
    @option 4 = "@deinstall"
    @option 0 = "@giveup"
@endoption

@if (0 [= @option) @exit @endif
@if (4 [= @option) @goto DE_INSTALL @endif

/*
 *  ASK USER IF HE/SHE WANTS A STANDARD OR CUSTOM INSTALLATION
 */

@getoption
    @cls
@describe1
@describe2
    @localwindow (20,40)
    @option 1 = "@standard"
    @option 2 = "@custom"
    @option 0 = "@giveup"
@endoption

@if (0 [= @option) @exit @endif

/*
 *  ASK USER HOW MANY SOCKETS ARE IN THE COMPUTER
 */

@getoption
    @cls
@asknumsockets
    @localwindow (10,39)         
    @option 11 = "1"
    @option 12 = "2"
    @option 13 = "3"
    @option 14 = "4"
@endoption

@definevars
    @if (11 [= @option)
	@qstring @sockets = "1"
    @elseif (12 [= @option)
	@qstring @sockets = "2"
    @elseif (13 [= @option)
	@qstring @sockets = "3"
    @elseif (14 [= @option)
	@qstring @sockets = "4"
    @endif
@endvars

@clearoption (50)               /* Later used as a return flag */

/*
 * ASK USER FOR THE DESTINATION DRIVE AND MAKE CERTAIN IT IS NOT A FLOPPY
 */

SELECT_DIRECTORY:

@GetOutDrive
@Suppress A @Suppress B
@cls    
@localwindow (14,39)
@askfordrive                
@EndOutDrive

@if (@Removable)
    @Display
    @notonfloppy
    @pause
    @abort
    @EndDisplay
@endif

/*
 *  ASK USER FOR THE DESTINATION DIRECTORY
 */

@getsubdir
@cls
@localwindow (10,50)         
@askforpath
    @prompt = "@pathprompt"
@endsubdir

/*
 *  ASK USER TO CONFIRM DESTINATION DRIVE AND DIRECTORY
 */

@getoption
    @checkbox
    @setoption (9)
    @cls
    @confirmdestination
    @toggle 
    @localwindow (9,39)             
    @option 9 = "@outdrive:@subdir"
@endoption

@if (!(9 [= @option)) @goto SELECT_DIRECTORY @endif

/*
 *  CREATE SUBDIRECTORY AND COPY TOOLS TO IT
 *
 *      - The subdir is created here in order to speed up the Install
 *        execution of the .exe tools such as card_bap, adapter, sysedit,
 *        csdetect, ssdetect, and vcb. 
 */

@display
	@cls
	@copytools
	@chdrive (@outdrive)
        @chdir ("\\")
	@mkdir ("@subdir")
	@chdir ("@subdir")
	
	@copy ("@indrive:\\@toolsdir\\adapter.exe", "@outdrive:\\@subdir\\adapter.exe")
	@copy ("@indrive:\\@toolsdir\\card_bap.exe", "@outdrive:\\@subdir\\card_bap.exe")
	@copy ("@indrive:\\@toolsdir\\sysedit.exe", "@outdrive:\\@subdir\\sysedit.exe")
	@copy ("@indrive:\\@toolsdir\\vcb.exe", "@outdrive:\\@subdir\\vcb.exe")
	@copy ("@indrive:\\@toolsdir\\ssdetect.exe", "@outdrive:\\@subdir\\ssdetect.exe")
	@copy ("@indrive:\\@toolsdir\\csdetect.exe", "@outdrive:\\@subdir\\csdetect.exe")
        @copy ("@outdrive:\\@subdir\\csalloc.ini", "@outdrive:\\@subdir\\csal_ini.old")
        @copy ("@outdrive:\\@subdir\\cardid.ini", "@outdrive:\\@subdir\\card_ini.old")
@enddisplay

@if (50 [= @option) @goto STANDARD_INSTALL @endif  /* Check for a return flag */

/*
 *  SYSTEM TESTING FOR SPECIAL CONFIGURATION
 *
 *      - Checks for existence of SystemSoft BIOS then check customer number
 *        to determine if machine is Gateway Colorbook platform.  If so, 
 *        set flag to later BAP CardStatusChange IRQ to A. 
 */

@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")

@display
	@cls
	@checksystem
	@if (@exists("vcb.exe"))
		@if (@spawn("vcb ff00-ffff /q")) @endif
		@cls
		@checksystem
	  @if (@exists("sysedit.exe"))
		@if (@spawn("sysedit -t vcb.txt 2209-"))
			@setoption (40)
			@cls
			@checksystem
		@endif
	  @endif
          @delete ("vcb.txt")
	@endif
@enddisplay


/*
 * CHECK FOR PRE-EXSISTING PCMCIA SOFTWARE
 *
 *      - Uses tools called ssdetect.exe and csdetect.exe to check for 
 *        pre-existing CardServices and SocketServices.  If found, either
 *        change certain parameters (/ADA) or prompt user before installing
 *        over old configurations.
 */

@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")

@display
   @cls
   @checksystem
   @if (@exists "csdetect.exe")
	@if (@spawn ("csdetect.exe") == 1)
		@setoption (30)                         /* CrdSrv found, warn user */
	@elseif (@exists "ssdetect.exe")
		@if (@spawn ("ssdetect.exe") == 1)
			@setoption (32)                 /* SktSrv must be in ROM */
		@endif
	@endif
   @endif
@cls
@enddisplay

@if (!(30 [= @option))
	@goto BEGIN_ADAPTER_SEARCH 
@endif

@getoption
      @PCMCIAfound
      @whatnext1
      @ifignore
      @localwindow (19,40)
      @option 4 = "@deinstall"
      @option 0 = "@giveup"
      @option 5 = "@continue"
@endoption     

@if (0 [= @option) @exit @endif
@if (4 [= @option) @goto DE_INSTALL @endif        

/* if option 5 continue normally */

/*
 * DETERMINE WHICH SOCKET SERVICES IS NEEDED
 *
 *      - Uses the adapter.exe tool to determine which adapter is present
 *        then sets flag accordingly.  If the appropriate socket service
 *        driver is not found on the diskette or if the adapter was unknown
 *        the user is prompted for which socket services to install.
 */

BEGIN_ADAPTER_SEARCH:

@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")

@display
    @adasearch
    @if (@spawn ("adapter") == 1)
	@if (@exists "@indrive:\\@sourcedir\\ss365sl.exe")
	    @setoption (101)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @365sl @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 6 || @spawn () == 7)
	@if ((40 [= @option) && (@exists "@indrive:\\@sourcedir\\SOTC2204\\sscirrus.exe"))
	    @setoption (111)
	@elseif (@exists "@indrive:\\@sourcedir\\sscirrus.exe")
	    @setoption (105)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @cirrus @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 2 || @spawn () == 3)
	@if (@spawn () == 2)
	    @setoption (576)    /* hex 240 for databook port */
	@else
	    @setoption (704)    /* hex 2C0 for databook port */
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssdbook.exe")
	    @setoption (102)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @databook @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 9 || @spawn () == 10 || @spawn () == 11)
	@if (@exists "@indrive:\\@sourcedir\\ssvadem.exe")
	    @setoption (106)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @vadem @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 13)
	@if (@exists "@indrive:\\@sourcedir\\ssibm720.exe")
	    @setoption (109)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @ibm720 @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 8)
	@if (@exists "@indrive:\\@sourcedir\\ssvlsi.exe")
	    @setoption (107)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @vlsi @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 12)
	@if (@exists "@indrive:\\@sourcedir\\ss365lp.exe")
	    @setoption (108)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @365lp @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 4)
	@if (@exists "@indrive:\\@sourcedir\\ss6941.exe")
	    @setoption (103)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @6941 @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @elseif (@spawn () == 5)
	@if (@exists "@indrive:\\@sourcedir\\ss6942.exe")
	    @setoption (104)
	@else
	    @setoption (100)
	    @cls
	    @musthavess0 @6942 @musthavess1
	    @ssnotpresent
	    @pause
	@endif
    @endif
@enddisplay

@if (101 [= @option ||
	102 [= @option ||
	103 [= @option ||
	104 [= @option ||
	105 [= @option ||
	111 [= @option ||
	106 [= @option ||
	107 [= @option ||
	108 [= @option ||
	109 [= @option ||
	100 [= @option ||
	576 [= @option ||
	704 [= @option )

@goto END_ADAPTER_SEARCH
@endif        

@getoption
	@if (@exists "@indrive:\\@sourcedir\\ss365sl.exe")
	    @checkbox
	    @option 101 = "@ss365sl"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssdbook.exe")
	    @checkbox
	    @option 102 = "@ssdatabook"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ss6941.exe")
	    @checkbox
	    @option 103 = "@ss6941"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ss6942.exe")
	    @checkbox
	    @option 104 = "@ss6942"
	@endif
	@if ((40 [= @option) && (@exists "@indrive:\\@sourcedir\\SOTC2204\\sscirrus.exe"))
	    @checkbox
	    @option 111 = "@sscirrus"
	@elseif (@exists "@indrive:\\@sourcedir\\sscirrus.exe")
	    @checkbox
	    @option 105 = "@sscirrus"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssvadem.exe")
	    @checkbox
	    @option 106 = "@ssvadem"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssvlsi.exe")
	    @checkbox
	    @option 107 = "@ssvlsi"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ss365lp.exe")
	    @checkbox
	    @option 108 = "@ss365lp"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssibm720.exe")
	    @checkbox
	    @option 109 = "@ssibm720"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssppec.exe")
	    @checkbox
	    @option 110 = "@ssppec"
	@endif
	@if (!(@exists "@indrive:\\@sourcedir\\ss365sl.exe" ||
	     @exists "@indrive:\\@sourcedir\\ssdbook.exe" ||
	     @exists "@indrive:\\@sourcedir\\ss6941.exe" ||
	     @exists "@indrive:\\@sourcedir\\ss6942.exe" ||
	     @exists "@indrive:\\@sourcedir\\sscirrus.exe" ||
	     @exists "@indrive:\\@sourcedir\\SOTC2204\\sscirrus.exe" ||
	     @exists "@indrive:\\@sourcedir\\ssvadem.exe" ||
	     @exists "@indrive:\\@sourcedir\\ssvlsi.exe" ||
	     @exists "@indrive:\\@sourcedir\\ss365lp.exe" ||
	     @exists "@indrive:\\@sourcedir\\ssibm720.exe" ||
	     @exists "@indrive:\\@sourcedir\\ssppec.exe" ))
	    @checkbox
	    @ssnotpresent                
	    @option 199 = "@ssnone"
	@endif
	@option 199 = "@ssnone"
	@cls
	@adanotfound
	@localwindow (16,38)
@endoption

END_ADAPTER_SEARCH:

@if (1 [= @option) @goto STANDARD_INSTALL @endif

/*
 * ---------------------------------------------------------------------
 * ----------------------- CUSTOM INSTALLATION -------------------------
 *
 *   This part of the Install Utility will allow the user to choose 
 *   which drivers and utilities she/he wants to install.
 *
 */

CUSTOM_INSTALL:

@getoption
@checkbox
    @if (101 [= @option) @option 101 = "@ss365sl" @endif
    @if (102 [= @option) @option 102 = "@ssdatabook" @endif
    @if (103 [= @option) @option 103 = "@ss6941" @endif
    @if (104 [= @option) @option 104 = "@ss6942" @endif
    @if (105 [= @option) @option 105 = "@sscirrus" @endif
    @if (106 [= @option) @option 106 = "@ssvadem" @endif
    @if (107 [= @option) @option 107 = "@ssvlsi" @endif
    @if (108 [= @option) @option 108 = "@ss365lp" @endif
    @if (109 [= @option) @option 109 = "@ssibm720" @endif
    @if (110 [= @option) @option 110 = "@ssppec" @endif
    @if (111 [= @option) @option 111 = "@sscirrus" @endif
    @if (@exists "@indrive:\\@sourcedir\\cs.exe")
	@setoption (200)
	@option 200  = "@cardservices"
    @endif
    @if (@exists "@indrive:\\@sourcedir\\csalloc.exe")
	@setoption (201)
	@option 201  = "@csalloc"
    @endif
    @if (@exists "@indrive:\\@sourcedir\\csalloc.ini")
        @if (@exists "@outdrive:\\@subdir\\csalloc.ini")
	        @setoption (202)
	        @option 202  = "@csallocini"
        @else @setoption (202)    
        @endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\atadrv.exe")
	@setoption (300)
	@option 300  = "@atadrv"
	@if (@exists "@indrive:\\@sourcedir\\atainit.exe")
		@setoption (301)
		@option 301 = "@atainit"
	@endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\mtddrv.exe")
	@setoption (407)
	@option 407  = "@mtd"
	@if (@exists "@indrive:\\@sourcedir\\mtaa.exe")
		@setoption (401)
		@option 401  = "@mtaa"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mtab.exe")
		@setoption (402)
		@option 402  = "@mtab"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mti1.exe")
		@setoption (412)
		@option 412  = "@mti1"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mti2p.exe")
		@setoption (405)
		@option 405  = "@mti2p"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mtsram.exe")
		@setoption (406)
		@option 406  = "@mtsram"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\dblflash.exe")
	   @setoption (404)
	   @option 404  = "@dblflash"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
	   @setoption (403)
	   @option 403  = "@msflash"
	@elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
	   @setoption (411)
	   @option 411  = "@msflash"
	@endif
    @elseif (@exists "@indrive:\\@sourcedir\\sramdrv.exe")
	@setoption (409)
	@option 409  = "@sramdrv"
    @elseif (@exists "@indrive:\\@sourcedir\\memdrv.exe")
	@setoption (410)
	@option 410  = "@memdrv"
	@if (@exists "@indrive:\\@sourcedir\\dblflash.exe")
	   @setoption (404)
	   @option 404  = "@dblflash"
	@endif
	@if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
	   @setoption (403)
	   @option 403  = "@msflash"
	@elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
	   @setoption (411)
	   @option 411  = "@msflash"
	@endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cardid.exe")
	@setoption (1001)
	@option 1001 = "@cardid"
	@if (@exists "@indrive:\\@sourcedir\\genmodem.clb")
		@setoption (1005)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\sundisk5.clb")
		@setoption (1006)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
	@if (@exists "@indrive:\\@sourcedir\\genata.clb")
		@setoption (1007)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\intellan.clb")
		@setoption (1008)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\dlink.clb")
		@setoption (1009)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\linksys.clb")
		@setoption (1010)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\socketea.clb")
		@setoption (1011)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\linksys2.clb")
		@setoption (1012)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\ibm3270.clb")
		@setoption (1013)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\ibmtok.clb")
		@setoption (1014)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\ibmlan.clb")
		@setoption (1015)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\wd.clb")
		@setoption (1016)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
        @endif        
        @if (@exists "@indrive:\\@sourcedir\\cbdas.clb")
                @setoption (1017)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
	@endif
        @if (@exists "@indrive:\\@sourcedir\\proxim.clb")
                @setoption (1018)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
	@endif
        @if (@exists "@indrive:\\@sourcedir\\xircom.clb")
                @setoption (1019)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
	@endif
        @if (@exists "@indrive:\\@sourcedir\\tdklan2.clb")
                @setoption (1020)
		@if (!(1003 [= @option)) 
                        @setoption (1003)
                        @option 1003 = "@cardlib"
                @endif
	@endif
        @if (@exists "@indrive:\\@sourcedir\\cardid.ini")
	        @if (@exists "@outdrive:\\@subdir\\cardid.ini")
		        @setoption (1004)
		        @option 1004 = "@cardidini"
	        @else @setoption (1004)
                @endif
	@endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cs_apm.exe")
        @setoption (1002)
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cardinfo.exe")
	@setoption (1100)
	@option 1100 = "@cardinfo"
    @endif
    @if (@exists "@indrive:\\@sourcedir\\memcard.exe")
	@setoption (408)
	@option 408  = "@memcard"
    @endif
    @if (@exists "@indrive:\\@sourcedir\\config.exe")
	@setoption (1101)
	@option 1101 = "@config"
    @endif
@localwindow (15,38)
@cls
@askforcomps @toggle
@endoption

/*
 * IF ANY OF THE COMPONENTS ALREADY EXIST IN THE OUTPUT DIRECTORY, THEN ASK
 * THE USER TO CONFIRM HIS/HER SELECTIONS SO NOT TO OVER-WRITE.
 */

@if ((101 [= @option && @exists "@outdrive:\\@subdir\\ss365sl.exe") ||
     (102 [= @option && @exists "@outdrive:\\@subdir\\ssdbook.exe") ||
     (103 [= @option && @exists "@outdrive:\\@subdir\\ss6941.exe") ||
     (104 [= @option && @exists "@outdrive:\\@subdir\\ss6942.exe") ||
     (105 [= @option && @exists "@outdrive:\\@subdir\\sscirrus.exe") ||
     (111 [= @option && @exists "@outdrive:\\@subdir\\sscirrus.exe") ||
     (106 [= @option && @exists "@outdrive:\\@subdir\\ssvadem.exe") ||
     (107 [= @option && @exists "@outdrive:\\@subdir\\ssvlsi.exe") ||
     (108 [= @option && @exists "@outdrive:\\@subdir\\ss365lp.exe") ||
     (109 [= @option && @exists "@outdrive:\\@subdir\\ssibm720.exe") ||
     (110 [= @option && @exists "@outdrive:\\@subdir\\ssppec.exe") ||
     (200 [= @option && @exists "@outdrive:\\@subdir\\cs.exe") ||
     (201 [= @option && @exists "@outdrive:\\@subdir\\csalloc.exe") ||
     (202 [= @option && @exists "@outdrive:\\@subdir\\csalloc.ini") ||
     (300 [= @option && @exists "@outdrive:\\@subdir\\atadrv.exe") ||
     (301 [= @option && @exists "@outdrive:\\@subdir\\atainit.exe") ||
     (401 [= @option && @exists "@outdrive:\\@subdir\\mtaa.exe") ||
     (402 [= @option && @exists "@outdrive:\\@subdir\\mtab.exe") ||
     (403 [= @option && @exists "@outdrive:\\@subdir\\ssmsflash.sys") ||
     (411 [= @option && @exists "@outdrive:\\@subdir\\ms-flash.sys") ||
     (404 [= @option && @exists "@outdrive:\\@subdir\\dblflash.exe") ||
     (412 [= @option && @exists "@outdrive:\\@subdir\\mti1.exe") ||
     (405 [= @option && @exists "@outdrive:\\@subdir\\mti2p.exe") ||
     (406 [= @option && @exists "@outdrive:\\@subdir\\mtsram.exe") ||
     (407 [= @option && @exists "@outdrive:\\@subdir\\mtddrv.exe") ||
     (408 [= @option && @exists "@outdrive:\\@subdir\\memcard.exe") ||
     (409 [= @option && @exists "@outdrive:\\@subdir\\sramdrv.exe") ||
     (410 [= @option && @exists "@outdrive:\\@subdir\\memdrv.exe") ||
     (1001 [= @option && @exists "@outdrive:\\@subdir\\cardid.exe") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\genmodem.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\sundisk5.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\genata.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\intellan.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\dlink.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\linksys.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\socketea.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\linksys2.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\ibm3270.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\ibmtok.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\ibmlan.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\wd.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\cbdas.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\proxim.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\tdklan2.clb") ||
     (1003 [= @option && @exists "@outdrive:\\@subdir\\xircom.clb") ||
     (1004 [= @option && @exists "@outdrive:\\@subdir\\cardid.ini") ||
     (1002 [= @option && @exists "@outdrive:\\@subdir\\cs_apm.exe") ||
     (1100 [= @option && @exists "@outdrive:\\@subdir\\cardinfo.exe") ||
     (1101 [= @option && @exists "@outdrive:\\@subdir\\config.exe"))
    @getoption
    @checkbox
    @if (101 [= @option && @exists "@outdrive:\\@subdir\\ss365sl.exe")
	@option 101 = "@ss365sl"
    @endif
    @if (102 [= @option && @exists "@outdrive:\\@subdir\\ssdbook.exe")
	@option 102 = "@ssdatabook"
    @endif
    @if (103 [= @option && @exists "@outdrive:\\@subdir\\ss6941.exe")
	@option 103 = "@ss6941"
    @endif
    @if (104 [= @option && @exists "@outdrive:\\@subdir\\ss6942.exe")
	@option 104 = "@ss6942"
    @endif
    @if (105 [= @option && @exists "@outdrive:\\@subdir\\sscirrus.exe")
	@option 105 = "@sscirrus"
    @endif
    @if (111 [= @option && @exists "@outdrive:\\@subdir\\sscirrus.exe")
	@option 111 = "@sscirrus"
    @endif
    @if (106 [= @option && @exists "@outdrive:\\@subdir\\ssvadem.exe")
	@option 106 = "@ssvadem"
    @endif
    @if (107 [= @option && @exists "@outdrive:\\@subdir\\ssvlsi.exe")
	@option 107 = "@ssvlsi"
    @endif
    @if (108 [= @option && @exists "@outdrive:\\@subdir\\ss365lp.exe")
	@option 108 = "@ss365lp"
    @endif
    @if (109 [= @option && @exists "@outdrive:\\@subdir\\ssibm720.exe")
	@option 109 = "@ssibm720"
    @endif
    @if (110 [= @option && @exists "@outdrive:\\@subdir\\ssppec.exe")
	@option 110 = "@ssppec"
    @endif
    @if (200 [= @option && @exists "@outdrive:\\@subdir\\cs.exe")
	@option 200  = "@cardservices"
    @endif
    @if (201 [= @option && @exists "@outdrive:\\@subdir\\csalloc.exe")
	@option 201  = "@csalloc"
    @endif
    @if (202 [= @option && @exists "@outdrive:\\@subdir\\csalloc.ini")
	@option 202  = "@csallocini"
    @endif
    @if (300 [= @option && @exists "@outdrive:\\@subdir\\atadrv.exe")
	@option 300  = "@atadrv"
    @endif
    @if (301 [= @option && @exists "@outdrive:\\@subdir\\atainit.exe")
	@option 301  = "@atainit"
    @endif
    @if (407 [= @option && @exists "@outdrive:\\@subdir\\mtddrv.exe")
	@option 407  = "@mtd"
    @endif
    @if (401 [= @option && @exists "@outdrive:\\@subdir\\mtaa.exe")
	@option 401  = "@mtaa"
    @endif
    @if (402 [= @option && @exists "@outdrive:\\@subdir\\mtab.exe")
	@option 402  = "@mtab"
    @endif
    @if (412 [= @option && @exists "@outdrive:\\@subdir\\mti1.exe")
	@option 412  = "@mti1"
    @endif
    @if (405 [= @option && @exists "@outdrive:\\@subdir\\mti2p.exe")
	@option 405  = "@mti2p"
    @endif
    @if (406 [= @option && @exists "@outdrive:\\@subdir\\mtsram.exe")
	@option 406  = "@mtsram"
    @endif
    @if (404 [= @option && @exists "@outdrive:\\@subdir\\dblfash.exe")
	@option 404  = "@dblflash"
    @endif
    @if (403 [= @option && @exists "@outdrive:\\@subdir\\ssmsflsh.sys")
	@option 403  = "@msflash"
    @endif
    @if (411 [= @option && @exists "@outdrive:\\@subdir\\ms-flash.sys")
	@option 411  = "@msflash"
    @endif
    @if (409 [= @option && @exists "@outdrive:\\@subdir\\sramdrv.exe")
	@option 409  = "@sramdrv"
    @endif
    @if (410 [= @option && @exists "@outdrive:\\@subdir\\memdrv.exe")
	@option 410  = "@memdrv"
    @endif
    @if (408 [= @option && @exists "@outdrive:\\@subdir\\memcard.exe")
	@option 408  = "@memcard"
    @endif
    @if (1001 [= @option && @exists "@outdrive:\\@subdir\\cardid.exe")
	@option 1001 = "@cardid"
    @endif
    @if (1003 [= @option)
      @if ((1005 [= @option) && (@exists "@outdrive:\\@subdir\\genmodem.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
     	@option 1003 = "@cardlib"
      @elseif ((1006 [= @option) && (@exists "@outdrive:\\@subdir\\sundisk5.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
     	@option 1003 = "@cardlib"
      @elseif ((1007 [= @option) && (@exists "@outdrive:\\@subdir\\genata.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1008 [= @option) && (@exists "@outdrive:\\@subdir\\intellan.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1009 [= @option) && (@exists "@outdrive:\\@subdir\\dlink.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1010 [= @option) && (@exists "@outdrive:\\@subdir\\linksys.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1011 [= @option) && (@exists "@outdrive:\\@subdir\\socketea.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1012 [= @option) && (@exists "@outdrive:\\@subdir\\linksys2.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1013 [= @option) && (@exists "@outdrive:\\@subdir\\ibm3270.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1014 [= @option) && (@exists "@outdrive:\\@subdir\\ibmtok.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1015 [= @option) && (@exists "@outdrive:\\@subdir\\ibmlan.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1016 [= @option) && (@exists "@outdrive:\\@subdir\\wd.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1017 [= @option) && (@exists "@outdrive:\\@subdir\\cbdas.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1018 [= @option) && (@exists "@outdrive:\\@subdir\\proxim.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1019 [= @option) && (@exists "@outdrive:\\@subdir\\xircom.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @elseif ((1020 [= @option) && (@exists "@outdrive:\\@subdir\\tdklan2.clb"))
        @if (@spawn ("attrib -R *.clb")) @endif 
      	@option 1003 = "@cardlib"
      @endif
    @endif
    @if (1004 [= @option && @exists "@outdrive:\\@subdir\\cardid.ini")
	@option 1004 = "@cardidini"
    @endif
    @if (1002 [= @option && @exists "@outdrive:\\@subdir\\cs_apm.exe")
        @option 1002 = "@csapm"
    @endif
    @if (1100 [= @option && @exists "@outdrive:\\@subdir\\cardinfo.exe")
	@option 1100 = "@cardinfo"
    @endif
    @if (1101 [= @option && @exists "@outdrive:\\@subdir\\config.exe")
	@option 1101  = "@config"
    @endif
    @cls
    @thesefilesexist @outdrive:@subdir.
    @askforover
    @localwindow (14,38)
@endoption
@endif

/*
 *  LOAD UP THE FILES SELECTED BY THE USER.
 */

@if ( 101 [= @option ||
	  102 [= @option ||
	  103 [= @option ||
	  104 [= @option ||
	  105 [= @option ||
	  106 [= @option ||
	  107 [= @option ||
	  108 [= @option ||
	  109 [= @option ||
	  110 [= @option ||
	  111 [= @option ||
	  200 [= @option ||
	  201 [= @option ||
	  202 [= @option ||
	  300 [= @option ||
	  301 [= @option ||     
	  401 [= @option ||
	  402 [= @option ||
	  403 [= @option ||
	  404 [= @option ||
	  405 [= @option ||
	  406 [= @option ||
	  407 [= @option ||
	  408 [= @option ||
	  409 [= @option ||
	  410 [= @option ||
	  411 [= @option ||
	  412 [= @option ||
	 1000 [= @option ||
	 1001 [= @option ||
	 1002 [= @option ||
	 1003 [= @option ||
	 1004 [= @option ||
	 1100 [= @option ||
	 1101 [= @option)
	@definedisk
	@label = "Disk 1"
	@file @sourcedir\ss365sl.exe  @option  101 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ssdbook.exe  @option  102 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ss6941.exe   @option  103 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ss6942.exe   @option  104 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\sscirrus.exe @option  105 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ssvadem.exe  @option  106 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ssvlsi.exe   @option  107 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ss365lp.exe  @option  108 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ssibm720.exe @option  109 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ssppec.exe   @option  110 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\SOTC2204\sscirrus.exe @option  111 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\cs.exe       @option  200 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\csalloc.exe  @option  201 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\csalloc.ini  @option  202 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mtaa.exe     @option  401 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mtab.exe     @option  402 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mti1.exe     @option  412 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mti2p.exe    @option  405 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mtsram.exe   @option  406 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\mtddrv.exe   @option  407 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\dblflash.exe @option  404 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\sramdrv.exe  @option  409 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\memdrv.exe   @option  410 @out @outdrive:\\@subdir\\*.*
	@if ((407 [= @option) || (410 [= @option))
	    @if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
		    @file @sourcedir\ssmsflsh.sys @option 403 @out @outdrive:\\@subdir\\*.*
	    @elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
		    @file @sourcedir\ms-flash.sys @option 411 @out @outdrive:\\@subdir\\*.*
	    @endif
	@endif
	@file @sourcedir\memcard.exe  @option  408 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\atadrv.exe   @option  300 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\atainit.exe  @option  301 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\cardid.exe   @option 1001 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\cardid.ini   @option 1004 @out @outdrive:\\@subdir\\*.*
	@if (1003 [= @option)
        @file @sourcedir\genmodem.clb @option 1005 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\sundisk5.clb @option 1006 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\genata.clb   @option 1007 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\intellan.clb @option 1008 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\dlink.clb    @option 1009 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\linksys.clb  @option 1010 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\socketea.clb @option 1011 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\linksys2.clb @option 1012 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ibm3270.clb  @option 1013 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ibmtok.clb   @option 1014 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\ibmlan.clb   @option 1015 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\wd.clb       @option 1016 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\cbdas.clb    @option 1017 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\proxim.clb   @option 1018 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\xircom.clb   @option 1019 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\tdklan2.clb  @option 1020 @out @outdrive:\\@subdir\\*.*
        @endif
	@file @sourcedir\cs_apm.exe   @option 1002 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\cardinfo.exe @option 1100 @out @outdrive:\\@subdir\\*.*
	@file @sourcedir\config.exe   @option 1101 @out @outdrive:\\@subdir\\*.*
	@enddisk
@endif

@chdir ("\\")
@chdrive (C)
@chdir ("\\")

/*
 * CHECK FOR PREVIOUS EXISTENCE OF ANY DRIVERS SO TO ADD TO CONFIG.SYS
 */

@if (((!(101 [= @option)) && @exists "@outdrive:\\@subdir\\ss365sl.exe")  ||
     ((!(102 [= @option)) && @exists "@outdrive:\\@subdir\\ssdbook.exe")  ||
     ((!(103 [= @option)) && @exists "@outdrive:\\@subdir\\ss6941.exe")   ||
     ((!(104 [= @option)) && @exists "@outdrive:\\@subdir\\ss6942.exe")   ||
     (       (  (!(105 [= @option)) && 
                @exists "@outdrive:\\@subdir\\sscirrus.exe"  ) &&
                (!(111 [= @option))                                     ) ||
     ((!(106 [= @option)) && @exists "@outdrive:\\@subdir\\ssvadem.exe")  ||
     ((!(107 [= @option)) && @exists "@outdrive:\\@subdir\\ssvlsi.exe")   ||
     ((!(108 [= @option)) && @exists "@outdrive:\\@subdir\\ss365lp.exe")  ||
     ((!(109 [= @option)) && @exists "@outdrive:\\@subdir\\ssibm720.exe") ||
     ((!(110 [= @option)) && @exists "@outdrive:\\@subdir\\ssppec.exe")   ||
     ((!(200 [= @option)) && @exists "@outdrive:\\@subdir\\cs.exe")       ||
     ((!(201 [= @option)) && @exists "@outdrive:\\@subdir\\csalloc.exe")  ||
     ((!(300 [= @option)) && @exists "@outdrive:\\@subdir\\atadrv.exe")   ||
     ((!(401 [= @option)) && @exists "@outdrive:\\@subdir\\mtaa.exe")     ||
     ((!(402 [= @option)) && @exists "@outdrive:\\@subdir\\mtab.exe")     ||
     ((!(412 [= @option)) && @exists "@outdrive:\\@subdir\\mti1.exe")     ||
     ((!(405 [= @option)) && @exists "@outdrive:\\@subdir\\mti2p.exe")    ||
     ((!(406 [= @option)) && @exists "@outdrive:\\@subdir\\mtsram.exe")   ||
     ((!(407 [= @option)) && @exists "@outdrive:\\@subdir\\mtddrv.exe")   ||
     ((!(404 [= @option)) && @exists "@outdrive:\\@subdir\\dblflash.exe") ||
     ((!(403 [= @option)) && @exists "@outdrive:\\@subdir\\ssmsflsh.sys") ||
     ((!(411 [= @option)) && @exists "@outdrive:\\@subdir\\ms-flash.sys") ||
     ((!(409 [= @option)) && @exists "@outdrive:\\@subdir\\sramdrv.exe")  ||
     ((!(410 [= @option)) && @exists "@outdrive:\\@subdir\\memdrv.exe")   ||    
     ((!(1001 [= @option)) && @exists "@outdrive:\\@subdir\\cardid.exe"))
    @getoption
    @checkbox
    @if ((!(101 [= @option)) && @exists "@outdrive:\\@subdir\\ss365sl.exe")
	@option 101 = "@ss365sl"
    @endif
    @if ((!(102 [= @option)) && @exists "@outdrive:\\@subdir\\ssdbook.exe")
	@option 102 = "@ssdatabook"
    @endif
    @if ((!(103 [= @option)) && @exists "@outdrive:\\@subdir\\ss6941.exe")
	@option 103 = "@ss6941"
    @endif
    @if ((!(104 [= @option)) && @exists "@outdrive:\\@subdir\\ss6942.exe")
	@option 104 = "@ss6942"
    @endif
    @if ((!(105 [= @option)) && @exists "@outdrive:\\@subdir\\sscirrus.exe")
        @if (!(111 [= @option))
                @option 105 = "@sscirrus"
        @endif
    @elseif ((!(111 [= @option)) && @exists "@outdrive:\\@subdir\\sscirrus.exe")
        @if (!(105 [= @option))
                @option 111 = "@sscirrus"
        @endif
    @endif
    @if ((!(106 [= @option)) && @exists "@outdrive:\\@subdir\\ssvadem.exe")
	@option 106 = "@ssvadem"
    @endif
    @if ((!(107 [= @option)) && @exists "@outdrive:\\@subdir\\ssvlsi.exe")
	@option 107 = "@ssvlsi"
    @endif
    @if ((!(108 [= @option)) && @exists "@outdrive:\\@subdir\\ss365lp.exe")
	@option 108 = "@ss365lp"
    @endif
    @if ((!(109 [= @option)) && @exists "@outdrive:\\@subdir\\ssibm720.exe")
	@option 109 = "@ssibm720"
    @endif
    @if ((!(110 [= @option)) && @exists "@outdrive:\\@subdir\\ssppec.exe")
	@option 110 = "@ssppec"
    @endif
    @if ((!(200 [= @option)) && @exists "@outdrive:\\@subdir\\cs.exe")
	@option 200  = "@cardservices"
    @endif
    @if ((!(201 [= @option)) && @exists "@outdrive:\\@subdir\\csalloc.exe")
	@option 201  = "@csalloc"
    @endif
    @if ((!(300 [= @option)) && @exists "@outdrive:\\@subdir\\atadrv.exe")
	@option 300  = "@atadrv"
    @endif
    @if ((!(407 [= @option)) && @exists "@outdrive:\\@subdir\\mtddrv.exe")
	@option 407  = "@mtd"
    @endif
    @if ((!(401 [= @option)) && @exists "@outdrive:\\@subdir\\mtaa.exe")
	@option 401  = "@mtaa"
    @endif
    @if ((!(402 [= @option)) && @exists "@outdrive:\\@subdir\\mtab.exe")
	@option 402  = "@mtab"
    @endif
    @if ((!(412 [= @option)) && @exists "@outdrive:\\@subdir\\mti1.exe")
	@option 412  = "@mti1"
    @endif
    @if ((!(405 [= @option)) && @exists "@outdrive:\\@subdir\\mti2p.exe")
	@option 405  = "@mti2p"
    @endif
    @if ((!(406 [= @option)) && @exists "@outdrive:\\@subdir\\mtsram.exe")
	@option 406  = "@mtsram"
    @endif
    @if ((!(404 [= @option)) && @exists "@outdrive:\\@subdir\\dblflash.exe")
	@option 404  = "@dblflash"
    @endif
    @if ((!(403 [= @option)) && @exists "@outdrive:\\@subdir\\ssmsflsh.sys")
	@option 403  = "@msflash"
    @endif
    @if ((!(411 [= @option)) && @exists "@outdrive:\\@subdir\\ms-flash.sys")
	@option 411  = "@msflash"
    @endif
    @if ((!(409 [= @option)) && @exists "@outdrive:\\@subdir\\sramdrv.exe")
	@option 409  = "@sramdrv"
    @endif
    @if ((!(410 [= @option)) && @exists "@outdrive:\\@subdir\\memdrv.exe")
	@option 410  = "@memdrv"
    @endif
    @if ((!(1001 [= @option)) && @exists "@outdrive:\\@subdir\\cardid.exe")
	@option 1001 = "@cardid"
    @endif
    @cls
    @askdevconfigsys
    @localwindow (14,40) 
    @endoption
@endif

/*
 * SWITCH TO THE ROOT DIRECTORY OF THE C DRIVE FOR CONFIG.SYS MODS
 */

@chdir ("\\")
@chdrive (C)
@chdir ("\\")
@chdir ("@subdir")

@getoption
    @checkbox
    @cls
    @askmodconfigsys
    @askmodconfigsys2@subdir@askmodconfigsys3
    @toggle 
    @setoption (99)
    @localwindow (17,39) 
    @option 99 = "@yesorno"
@endoption

@if (99 [= @option)
    @if (@exists "@outdrive:\\config.sys")
	@spawn ("sysedit -b @outdrive:\\config.sys")
	@display
	@if (@spawn() > 99)
	    @cls
	    @saveconfigsys.@spawn()
	    @cargrtn
	    @pause
	@elseif (@spawn() > 9)
	    @cls
	    @saveconfigsys.0@spawn()
	    @cargrtn
	    @pause
	@else
	    @cls
	    @saveconfigsys.00@spawn()
	    @cargrtn
	    @pause
	@endif
	@cls
	@enddisplay
    @else
	@copy ("@indrive:\\@sourcedir\\config.sys", "@outdrive:\\config.sys")
    @endif
    @display
    @cls
    @changingconfigsys
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss365sl.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssdbook.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss6941.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss6942.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys sscirrus.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssvadem.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssvlsi.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss365lp.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssibm720.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssppec.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cs.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys csalloc.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys atadrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys sramdrv.exe")) @endif
	@cls
	@changingconfigsys
	@if (@spawn ("sysedit -d @outdrive:\\config.sys memdrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtaa.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtab.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mti1.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mti2p.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtsram.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtddrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys dblflash.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssmsflsh.sys")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ms-flash.sys")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cic.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cardid.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cs_apm.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ralloc.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys s_ide.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys scard29.exe")) @endif
    @cls
    @changingconfigsys
    @if (101 [= @option ||
	 102 [= @option ||
	 103 [= @option ||
	 104 [= @option ||
	 105 [= @option ||
	 106 [= @option ||
	 107 [= @option ||
	 108 [= @option ||
	 109 [= @option ||
	 110 [= @option ||
	 111 [= @option ||
	 200 [= @option ||
	 201 [= @option ||
	 202 [= @option ||
	 300 [= @option ||
	 401 [= @option ||
	 402 [= @option ||
	 403 [= @option ||
	 404 [= @option ||
	 405 [= @option ||
	 406 [= @option ||
	 407 [= @option ||
	 409 [= @option ||
	 410 [= @option ||
	 411 [= @option ||
	 412 [= @option ||
	 1000 [= @option ||
	 1001 [= @option ||
         1003 [= @option)
	@if (!(@spawn ("sysedit -t @outdrive:\\config.sys @ver")))
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @rem @name PCMCIA DRIVERS")) @endif
	@endif
	@if (101 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS365SL.EXE")) @endif
	@elseif (102 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSDBOOK.EXE")) @endif
	@elseif (103 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS6941.EXE")) @endif
	@elseif (104 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS6942.EXE")) @endif
	@elseif (105 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@elseif (106 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSVADEM.EXE")) @endif
	@elseif (107 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSVLSI.EXE")) @endif
	@elseif (108 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS365LP.EXE")) @endif
	@elseif (109 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSIBM720.EXE")) @endif
	@elseif (110 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSPPEC.EXE")) @endif
	@elseif (111 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@endif
	@cls
	@changingconfigsys
	@if (200 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CS.EXE")) @endif
	@endif
	@if ((201 [= @option) || (202 [= @option))
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CSALLOC.EXE")) @endif
	@endif
	@if (300 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\ATADRV.EXE")) @endif
	@endif
	@if (407 [= @option)
	@if (401 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTAA.EXE")) @endif
	@endif
	@cls
	@changingconfigsys
	@if (402 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTAB.EXE")) @endif
	@endif
	@if (412 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTI1.EXE")) @endif
	@endif
	@if (405 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTI2P.EXE")) @endif
	@endif
	@if (406 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTSRAM.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTDDRV.EXE")) @endif
	@elseif (409 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SRAMDRV.EXE")) @endif
	@elseif (410 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MEMDRV.EXE")) @endif
	@endif
	@cls
	@changingconfigsys
	@if (404 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
	@endif
	@if (403 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
	@elseif (411 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
	@endif
	@if (1001 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CARDID.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys REMSSMARKER")) @endif
    @endif      
    @enddisplay

@elseif (!(99 [= @option))
	@chdir ("\\")
	@chdrive (@outdrive)
	@chdir ("\\")
	@chdir ("@subdir")
	@copy ("@outdrive:\\config.sys", "@outdrive:\\@subdir\\config.sys")
  @display
    @cls
    @changingconfigsys2
	@if (@spawn ("sysedit -d config.sys ss365sl.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssdbook.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss6941.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss6942.exe")) @endif
	@if (@spawn ("sysedit -d config.sys sscirrus.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssvadem.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssvlsi.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss365lp.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssibm720.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssppec.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cs.exe")) @endif
	@if (@spawn ("sysedit -d config.sys csalloc.exe")) @endif
	@if (@spawn ("sysedit -d config.sys atadrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys sramdrv.exe")) @endif
	@cls
	@changingconfigsys2
	@if (@spawn ("sysedit -d config.sys memdrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtaa.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtab.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mti1.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mti2p.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtsram.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtddrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys dblflash.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssmsflsh.sys")) @endif
	@if (@spawn ("sysedit -d config.sys ms-flash.sys")) @endif
	@if (@spawn ("sysedit -d config.sys cic.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cardid.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cs_apm.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ralloc.exe")) @endif
	@if (@spawn ("sysedit -d config.sys s_ide.exe")) @endif
	@if (@spawn ("sysedit -d config.sys scard29.exe")) @endif
	@cls
	@changingconfigsys2
	@if (!(@spawn ("sysedit -t config.sys @ver")))
	 @if (@spawn ("sysedit -a config.sys @rem @name PCMCIA DRIVERS")) @endif
	@endif
	@if (101 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS365SL.EXE")) @endif
	@elseif (102 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSDBOOK.EXE")) @endif
	@elseif (103 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS6941.EXE")) @endif
	@elseif (104 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS6942.EXE")) @endif
	@elseif (105 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@elseif (106 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSVADEM.EXE")) @endif
	@elseif (107 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSVLSI.EXE")) @endif
	@elseif (108 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS365LP.EXE")) @endif
	@elseif (109 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSIBM720.EXE")) @endif
	@elseif (110 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSPPEC.EXE")) @endif
	@elseif (111 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@endif
	@cls
	@changingconfigsys2
	@if (200 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CS.EXE")) @endif
	@endif
	@if ((201 [= @option) || (202 [= @option))
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CSALLOC.EXE")) @endif
	@endif
	@if (300 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\ATADRV.EXE")) @endif
	@endif
	@if (407 [= @option)
	@if (401 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTAA.EXE")) @endif
	@endif
	@cls
	@changingconfigsys2
	@if (402 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTAB.EXE")) @endif
	@endif
	@if (412 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTI1.EXE")) @endif
	@endif
	@if (405 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTI2P.EXE")) @endif
	@endif
	@if (406 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTSRAM.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTDDRV.EXE")) @endif
	@elseif (409 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SRAMDRV.EXE")) @endif
	@elseif (410 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MEMDRV.EXE")) @endif
	@endif
	@cls
	@changingconfigsys2
	@if (404 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
	@endif
	@if (403 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
	@elseif (411 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
	@endif
	@if (1001 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CARDID.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -d config.sys REMSSMARKER")) @endif
    @enddisplay
@endif

//  ADD LIBRARY ENTRIES TO END OF CARDID.INI FILE

@display
        @if ((1003 [= @option) && (@exists ("@outdrive:\\@subdir\\cardid.ini")))
                @cls
                @changingini
                @if (1006 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini SUNDISK5.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=SUNDISK5.CLB")) @endif
                        @endif
                @endif
                @if (1008 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini INTELLAN.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=INTELLAN.CLB")) @endif
                        @endif
                @endif
                @if (1009 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini DLINK.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=DLINK.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (1010 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini LINKSYS.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=LINKSYS.CLB")) @endif
                        @endif
                @endif
                @if (1012 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini LINKSYS2.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=LINKSYS2.CLB")) @endif
                        @endif
                @endif
                @if (1011 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini SOCKETEA.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=SOCKETEA.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (1015 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBMLAN.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBMLAN.CLB")) @endif
                        @endif
                @endif
                @if (1014 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBMTOK.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBMTOK.CLB")) @endif
                        @endif
                @endif
                @if (1013 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBM3270.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBM3270.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (1018 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini PROXIM.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=PROXIM.CLB")) @endif
                        @endif
                @endif
                @if (1017 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini CBDAS.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=CBDAS.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (1005 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini GENMODEM.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=GENMODEM.CLB")) @endif
                        @endif
                @endif
                @if (1007 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini GENATA.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=GENATA.CLB")) @endif
                        @endif
                @endif
                @if (1016 [= @option)
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini WD.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=WD.CLB")) @endif
                        @endif
                @endif
        @endif
@enddisplay

@goto FINISH

/*
 * --------------------------------------------------------------------------
 * ------------------- DEINSTALLATION PROCEDURE -----------------------------
 *
 *      - This procedure will REM out all SystemSoft CardSoft drivers from 
 *        the existing CONFIG.SYS file but will not delete the physical 
 *        files from the disk.  The original CONFIG.SYS file will be 
 *        renamed.
 */

DE_INSTALL:

@display
 @cls
 @destallintro
 @pause
@enddisplay

@chdir ("\\")
@chdrive (@outdrive)
@chdir ("\\")
@copy ("@indrive:\\@toolsdir\\sysedit.exe", "@outdrive:\\sysedit.exe")

@if (@exists "@outdrive:\\config.sys")
    @spawn ("sysedit -b @outdrive:\\config.sys")
    @display
    @if (@spawn() > 99)
	@cls
	@saveconfigsys.@spawn()
	@cargrtn
	@deinstalloptions.@spawn() @deinstalloptions2
	@pause
    @elseif (@spawn() > 9)
	@cls
	@saveconfigsys.0@spawn()
	@cargrtn
	@deinstalloptions.0@spawn() @deinstalloptions2
	@pause
    @else
	@cls
	@saveconfigsys.00@spawn()
	@cargrtn
	@deinstalloptions.00@spawn() @deinstalloptions2
	@pause
    @endif
	@cls
    @enddisplay
@endif

@display
   @cls
   @changingconfigsys
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ss365sl.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssdbook.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ss6941.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ss6942.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys sscirrus.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssvadem.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssvlsi.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ss365lp.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssibm720.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssppec.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys cs.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys csalloc.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys atadrv.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys sramdrv.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys memdrv.exe")) @endif
   @cls
   @changingconfigsys
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mtaa.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mtab.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mti1.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mti2p.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mtsram.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys mtddrv.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys dblflash.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ssmsflsh.sys")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ms-flash.sys")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys cic.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys cardid.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys cs_apm.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys ralloc.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys s_ide.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys scard29.exe")) @endif
   @if (@spawn ("sysedit -d @outdrive:\\config.sys REMSSMARKER")) @endif
   @cls
   @if (30 [= @option) 
     @rerun 
     @pause 
     @exit
   @endif
@delete ("@outdrive:\\sysedit.exe")
@enddisplay

@getoption
	@cls
	@deinstalldone
	@localwindow(16,38)
	@option 22 = "@noboot"
@endoption

@exit

/*
 * --------------------------------------------------------------------------
 * ------------------------ STANDARD INSTALLATION ---------------------------
 *
 *      - This part of the Install utility will load only the basics of the 
 *        CardSoft package, update the config.sys file, and BAP any necessary
 *        parameters for ease-of-use.
 */

STANDARD_INSTALL:

/*
 * IF ANY OF THE COMPONENTS ALREADY EXIST IN THE OUTPUT DIRECTORY, THEN TELL
 * THE USER THAT THE INSTALL WILL OVERWRITE THOSE FILES AND ASK THE USER TO
 * CONFIRM HIS/HER INSTALL CHOICE.
 */

@if (@exists "@outdrive:\\@subdir\\ss365sl.exe"  ||
	 @exists "@outdrive:\\@subdir\\ss365lp.exe"  ||
	 @exists "@outdrive:\\@subdir\\ssibm720.exe" ||
	 @exists "@outdrive:\\@subdir\\ssdbook.exe"  ||
	 @exists "@outdrive:\\@subdir\\ss6941.exe"   ||
	 @exists "@outdrive:\\@subdir\\ss6942.exe"   ||
	 @exists "@outdrive:\\@subdir\\sscirrus.exe" ||
	 @exists "@outdrive:\\@subdir\\ssvadem.exe"  ||
	 @exists "@outdrive:\\@subdir\\ssvlsi.exe"   ||
	 @exists "@outdrive:\\@subdir\\ssppec.exe"   ||
	 @exists "@outdrive:\\@subdir\\SOTC2204\\sscirrus.exe" ||
	 @exists "@outdrive:\\@subdir\\cs.exe"       ||
	 @exists "@outdrive:\\@subdir\\csalloc.exe"  ||
	 @exists "@outdrive:\\@subdir\\csalloc.ini"  ||
	 @exists "@outdrive:\\@subdir\\atadrv.exe"   ||
	 @exists "@outdrive:\\@subdir\\sramdrv.exe"  ||
	 @exists "@outdrive:\\@subdir\\memdrv.exe"   ||
	 @exists "@outdrive:\\@subdir\\mtddrv.exe"   ||
	 @exists "@outdrive:\\@subdir\\mtaa.exe"     ||
	 @exists "@outdrive:\\@subdir\\mtab.exe"     ||
	 @exists "@outdrive:\\@subdir\\mti1.exe"     ||
	 @exists "@outdrive:\\@subdir\\mti2p.exe"    ||
	 @exists "@outdrive:\\@subdir\\mtsram.exe"   ||
	 @exists "@outdrive:\\@subdir\\memcard.exe"  ||
	 @exists "@outdrive:\\@subdir\\dblflash.exe" ||
	 @exists "@outdrive:\\@subdir\\ssmsflsh.sys" ||
	 @exists "@outdrive:\\@subdir\\ms-flash.sys" ||
	 @exists "@outdrive:\\@subdir\\cardid.exe"   ||
	 @exists "@outdrive:\\@subdir\\cardid.ini"   ||
	 @exists "@outdrive:\\@subdir\\genmodem.clb" ||
	 @exists "@outdrive:\\@subdir\\sundisk5.clb" ||
	 @exists "@outdrive:\\@subdir\\genata.clb"   ||
	 @exists "@outdrive:\\@subdir\\intellan.clb" ||
	 @exists "@outdrive:\\@subdir\\dlink.clb"    ||
	 @exists "@outdrive:\\@subdir\\linksys.clb"  ||
	 @exists "@outdrive:\\@subdir\\socketea.clb" ||
	 @exists "@outdrive:\\@subdir\\linksys2.clb" ||
	 @exists "@outdrive:\\@subdir\\ibm3270.clb"  ||
	 @exists "@outdrive:\\@subdir\\ibmtok.clb"   ||
	 @exists "@outdrive:\\@subdir\\ibmlan.clb"   ||
	 @exists "@outdrive:\\@subdir\\wd.clb"       ||
	 @exists "@outdrive:\\@subdir\\cbdas.clb"    ||
         @exists "@outdrive:\\@subdir\\proxim.clb"   ||
         @exists "@outdrive:\\@subdir\\xircom.clb"   ||
         @exists "@outdrive:\\@subdir\\tdklan2.clb"  ||
	 @exists "@outdrive:\\@subdir\\cs_apm.exe"   ||
	 @exists "@outdrive:\\@subdir\\cardinfo.exe" ||
	 @exists "@outdrive:\\@subdir\\config.exe")
	@getoption
	@cls
	@somefilesexist@outdrive:@subdir
@describe3
@describe4
	@localwindow (19,39)
	@clearoption (1)
	@clearoption (2)
	@clearoption (3)
	@clearoption (0)
	@option 1 = "@standard"
	@option 3 = "@changedir"
	@option 2 = "@custom"
	@option 0 = "@giveup"
	@endoption
	@if (0 [= @option) @exit
	@elseif (2 [= @option) @goto CUSTOM_INSTALL
	@elseif (3 [= @option) 
	 @setoption (1)
	 @setoption (50)                /* Return flag set */
	 @goto SELECT_DIRECTORY
	@endif
@endif

/*
 * LOAD THE SOCKET SERVICES SPECIFIED BY THE OPTIONS SET ABOVE AND LOAD
 * ALL OTHER FILES THAT ARE PRESENT ON THE DISTRIBUTION DISK.
 */

@chdir ("\\")
@chdrive (@outdrive)
@chdir ("\\")

@definedisk
    @label = "Disk 1"
    @file @sourcedir\ss365sl.exe  @option  101 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ssdbook.exe  @option  102 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ss6941.exe   @option  103 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ss6942.exe   @option  104 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\sscirrus.exe @option  105 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ssvadem.exe  @option  106 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ssvlsi.exe   @option  107 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ss365lp.exe  @option  108 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ssibm720.exe @option  109 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\ssppec.exe   @option  110 @out @outdrive:\\@subdir\\*.*
    @file @sourcedir\SOTC2204\sscirrus.exe @option  111 @out @outdrive:\\@subdir\\*.*
    @if (@exists "@indrive:\\@sourcedir\\cs.exe")
	@file @sourcedir\cs.exe @out @outdrive:\\@subdir\\*.*
    @endif
    @if (@exists "@indrive:\\@sourcedir\\csalloc.exe")
	@file @sourcedir\csalloc.exe @out @outdrive:\\@subdir\\*.*
    @endif
    @if (@exists "@indrive:\\@sourcedir\\csalloc.ini")
	@file @sourcedir\csalloc.ini @out @outdrive:\\@subdir\\*.*
    @endif
    @if (@exists "@indrive:\\@sourcedir\\atadrv.exe")
	@file @sourcedir\atadrv.exe @out @outdrive:\\@subdir\\*.*
	@if (@exists "@indrive:\\@sourcedir\\atainit.exe")
	    @file @sourcedir\atainit.exe @out @outdrive:\\@subdir\\*.*
	@endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\mtddrv.exe")
	    @file @sourcedir\mtddrv.exe @out @outdrive:\\@subdir\\*.*
	    @if (@exists "@indrive:\\@sourcedir\\mtaa.exe")
		@file @sourcedir\mtaa.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\mtab.exe")
		@file @sourcedir\mtab.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\mti1.exe")
		@file @sourcedir\mti1.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\mti2p.exe")
		@file @sourcedir\mti2p.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\mtsram.exe")
		@file @sourcedir\mtsram.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\dblflash.exe")
		@file @sourcedir\dblflash.exe @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys") 
		@file @sourcedir\ssmsflsh.sys @out @outdrive:\\@subdir\\*.*
	    @elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
		@file @sourcedir\ms-flash.sys @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\memcard.exe")
		@file @sourcedir\memcard.exe @out @outdrive:\\@subdir\\*.*
	    @endif
    @elseif (@exists "@indrive:\\@sourcedir\\sramdrv.exe")
	    @file @sourcedir\sramdrv.exe @out @outdrive:\\@subdir\\*.*
    @elseif (@exists "@indrive:\\@sourcedir\\memdrv.exe")
	    @file @sourcedir\memdrv.exe @out @outdrive:\\@subdir\\*.*
	    @if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys") 
		@file @sourcedir\ssmsflsh.sys @out @outdrive:\\@subdir\\*.*
	    @elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
		@file @sourcedir\ms-flash.sys @out @outdrive:\\@subdir\\*.*
	    @endif
	    @if (@exists "@indrive:\\@sourcedir\\memcard.exe")
		@file @sourcedir\memcard.exe @out @outdrive:\\@subdir\\*.*
	    @endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cardid.exe")
	@file @sourcedir\cardid.exe @out @outdrive:\\@subdir\\*.*
	@if (@exists "@indrive:\\@sourcedir\\cardid.ini")
	    @if (7 [= @option) 
		@file @sourcedir\cardid.ini @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\cardid.ini")))
		@file @sourcedir\cardid.ini @out @outdrive:\\@subdir\\*.*
	    @endif
	@endif
	@if (@exists "@indrive:\\@sourcedir\\genmodem.clb")
            @if (@exists "@outdrive:\\@subdir\\genmodem.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\genmodem.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\genmodem.clb @out @outdrive:\\@subdir\\*.*
            @elseif (8 [=@option && (!(@exists "@outdrive:\\@subdir\\genmodem.clb")))
		@file @sourcedir\genmodem.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\sundisk5.clb")
            @if (@exists "@outdrive:\\@subdir\\sundisk5.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\sundisk5.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\sundisk5.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\sundisk5.clb")))
		@file @sourcedir\sundisk5.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\genata.clb")
            @if (@exists "@outdrive:\\@subdir\\genata.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\genata.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\genata.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\genata.clb")))
		@file @sourcedir\genata.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\intellan.clb")
            @if (@exists "@outdrive:\\@subdir\\intellan.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\intellan.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\intellan.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\intellan.clb")))
		@file @sourcedir\intellan.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\dlink.clb")
            @if (@exists "@outdrive:\\@subdir\\dlink.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\dlink.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\dlink.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\dlink.clb")))
		@file @sourcedir\dlink.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\linksys.clb")
            @if (@exists "@outdrive:\\@subdir\\linksys.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\linksys.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\linksys.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\linksys.clb")))
		@file @sourcedir\linksys.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\socketea.clb")
            @if (@exists "@outdrive:\\@subdir\\socketea.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\socketea.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\socketea.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\socketea.clb")))
		@file @sourcedir\socketea.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\linksys2.clb")
            @if (@exists "@outdrive:\\@subdir\\linksys2.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\linksys2.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\linksys2.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\linksys2.clb")))
		@file @sourcedir\linksys2.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\ibm3270.clb")
            @if (@exists "@outdrive:\\@subdir\\ibm3270.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\ibm3270.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\ibm3270.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\ibm3270.clb")))
		@file @sourcedir\ibm3270.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\ibmlan.clb")
            @if (@exists "@outdrive:\\@subdir\\ibmlan.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\ibmlan.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\ibmlan.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\ibmlan.clb")))
		@file @sourcedir\ibmlan.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\ibmtok.clb")
            @if (@exists "@outdrive:\\@subdir\\ibmtok.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\ibmtok.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\ibmtok.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\ibmtok.clb")))
		@file @sourcedir\ibmtok.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\wd.clb")
            @if (@exists "@outdrive:\\@subdir\\wd.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\wd.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\wd.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\wd.clb")))
		@file @sourcedir\wd.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\cbdas.clb")
            @if (@exists "@outdrive:\\@subdir\\cbdas.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\cbdas.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\cbdas.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\cbdas.clb")))
		@file @sourcedir\cbdas.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\proxim.clb")
            @if (@exists "@outdrive:\\@subdir\\proxim.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\proxim.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\proxim.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\proxim.clb")))
		@file @sourcedir\proxim.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\xircom.clb")
            @if (@exists "@outdrive:\\@subdir\\xircom.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\xircom.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\xircom.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\xircom.clb")))
		@file @sourcedir\xircom.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
	@if (@exists "@indrive:\\@sourcedir\\tdklan2.clb")
            @if (@exists "@outdrive:\\@subdir\\tdklan2.clb")
                @if (@spawn ("attrib -R @outdrive:\\@subdir\\tdklan2.clb")) @endif
            @endif
            @if (7 [= @option) 
		@file @sourcedir\tdklan2.clb @out @outdrive:\\@subdir\\*.*
	    @elseif (8 [= @option && (!(@exists "@outdrive:\\@subdir\\tdklan2.clb")))
		@file @sourcedir\tdklan2.clb @out @outdrive:\\@subdir\\*.*
            @endif
        @endif
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cs_apm.exe")
        @file @sourcedir\cs_apm.exe @out @outdrive:\\@subdir\\*.*
    @endif
    @if (@exists "@indrive:\\@sourcedir\\cardinfo.exe")
	@file @sourcedir\cardinfo.exe @out @outdrive:\\@subdir\\*.*
    @endif
    @if (@exists "@indrive:\\@sourcedir\\config.exe")
	@file @sourcedir\config.exe @out @outdrive:\\@subdir\\*.*
    @endif
@enddisk

/*
 * MODIFY CONFIG.SYS FOR ALL FILES TO LOAD (ALL FILES PRESENT ON THE
 * DISTRIBUTION DISK).
 */

@chdir ("\\")
@chdrive (C)
@chdir ("\\")
@chdir ("@subdir")

@getoption
    @checkbox
    @cls
    @askmodconfigsys
    @askmodconfigsys2@subdir@askmodconfigsys3
    @toggle 
    @setoption (99)
    @localwindow (17,39) 
    @option 99 = "@yesorno"
@endoption

@if (99 [= @option)
 @if (@exists "@outdrive:\\config.sys")
    @spawn ("sysedit -b @outdrive:\\config.sys")
    @display
    @if (@spawn() > 99)
	@cls
	@saveconfigsys.@spawn()
	@cargrtn
	@pause
    @elseif (@spawn() > 9)
	@cls
	@saveconfigsys.0@spawn()
	@cargrtn
	@pause
    @else
	@cls
	@saveconfigsys.00@spawn()
	@cargrtn
	@pause
    @endif
	@cls
    @enddisplay
 @else
	@copy ("@indrive:\\@sourcedir\\config.sys", "@outdrive:\\config.sys")
 @endif

@display
	@cls
	@changingconfigsys
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss365sl.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssdbook.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss6941.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss6942.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys sscirrus.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssvadem.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssvlsi.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ss365lp.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssibm720.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssppec.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cs.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys csalloc.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys atadrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys sramdrv.exe")) @endif
	@cls
	@changingconfigsys
	@if (@spawn ("sysedit -d @outdrive:\\config.sys memdrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtaa.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtab.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mti1.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mti2p.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtsram.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys mtddrv.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys dblflash.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ssmsflsh.sys")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ms-flash.sys")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cic.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cardid.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys cs_apm.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys ralloc.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys s_ide.exe")) @endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys scard29.exe")) @endif
	@cls
	@changingconfigsys
	@if (!(@spawn ("sysedit -t @outdrive:\\config.sys @ver")))
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @rem @name PCMCIA DRIVERS")) @endif
	@endif
	@if (101 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS365SL.EXE")) @endif
	@elseif (105 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@elseif (102 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSDBOOK.EXE")) @endif
	@elseif (106 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSVADEM.EXE")) @endif
	@elseif (107 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSVLSI.EXE")) @endif
	@elseif (108 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS365LP.EXE")) @endif
	@elseif (109 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSIBM720.EXE")) @endif
	@elseif (103 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS6941.EXE")) @endif
	@elseif (104 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SS6942.EXE")) @endif
	@elseif (110 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSPPEC.EXE")) @endif
	@elseif (111 [= @option)
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@endif
	@cls
	@changingconfigsys
	@if (@exists "@outdrive:\\@subdir\\cs.exe")
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CS.EXE")) @endif
	@endif
	@if (@exists "@outdrive:\\@subdir\\csalloc.exe")
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CSALLOC.EXE")) @endif
	@endif
	@if (@exists "@outdrive:\\@subdir\\atadrv.exe")
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\ATADRV.EXE")) @endif
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mtddrv.exe")
	 @if (@exists "@indrive:\\@sourcedir\\mtaa.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTAA.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mtab.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTAB.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mti1.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTI1.EXE")) @endif
	 @endif
	 @cls
	 @changingconfigsys
	 @if (@exists "@indrive:\\@sourcedir\\mti2p.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTI2P.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mtsram.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTSRAM.EXE")) @endif
	 @endif
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MTDDRV.EXE")) @endif

	 @if (@exists "@outdrive:\\@subdir\\dblflash.exe")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
	 @elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
	       @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
	 @endif
	@cls
	@changingconfigsys
	@elseif (@exists "@indrive:\\@sourcedir\\sramdrv.exe")
		@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SRAMDRV.EXE")) @endif    
	@elseif (@exists "@indrive:\\@sourcedir\\memdrv.exe")
		@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MEMDRV.EXE")) @endif
		@if (@exists "@outdrive:\\@subdir\\dblflash.exe")
			@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
		@endif
		@if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
			@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
		@elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
			@if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
		@endif
	@endif
	@cls
	@changingconfigsys
	@if (@exists "@outdrive:\\@subdir\\cardid.exe")
	 @if (@spawn ("sysedit -a @outdrive:\\config.sys @dev=@outdrive:\\@subdir\\CARDID.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -d @outdrive:\\config.sys REMSSMARKER")) @endif
@enddisplay

@elseif (!(99 [= @option))
	@chdir ("\\")
	@chdrive (@outdrive)
	@chdir ("\\")
	@chdir ("@subdir")
	@copy ("@outdrive:\\config.sys", "@outdrive:\\@subdir\\config.sys")
  @display
	@cls
	@changingconfigsys2
	@if (@spawn ("sysedit -d config.sys ss365sl.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssdbook.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss6941.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss6942.exe")) @endif
	@if (@spawn ("sysedit -d config.sys sscirrus.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssvadem.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssvlsi.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ss365lp.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssibm720.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssppec.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cs.exe")) @endif
	@if (@spawn ("sysedit -d config.sys csalloc.exe")) @endif
	@if (@spawn ("sysedit -d config.sys atadrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys sramdrv.exe")) @endif
	@cls
	@changingconfigsys2
	@if (@spawn ("sysedit -d config.sys memdrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtaa.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtab.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mti1.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mti2p.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtsram.exe")) @endif
	@if (@spawn ("sysedit -d config.sys mtddrv.exe")) @endif
	@if (@spawn ("sysedit -d config.sys dblflash.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ssmsflsh.sys")) @endif
	@if (@spawn ("sysedit -d config.sys ms-flash.sys")) @endif
	@if (@spawn ("sysedit -d config.sys cic.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cardid.exe")) @endif
	@if (@spawn ("sysedit -d config.sys cs_apm.exe")) @endif
	@if (@spawn ("sysedit -d config.sys ralloc.exe")) @endif
	@if (@spawn ("sysedit -d config.sys s_ide.exe")) @endif
	@if (@spawn ("sysedit -d config.sys scard29.exe")) @endif
	@cls
	@changingconfigsys2
	@if (!(@spawn ("sysedit -t config.sys @ver")))
	 @if (@spawn ("sysedit -a config.sys @rem @name PCMCIA DRIVERS")) @endif
	@endif
	@if (101 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS365SL.EXE")) @endif
	@elseif (105 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@elseif (102 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSDBOOK.EXE")) @endif
	@elseif (106 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSVADEM.EXE")) @endif
	@elseif (107 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSVLSI.EXE")) @endif
	@elseif (108 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS365LP.EXE")) @endif
	@elseif (109 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSIBM720.EXE")) @endif
	@elseif (103 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS6941.EXE")) @endif
	@elseif (104 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SS6942.EXE")) @endif
	@elseif (110 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSPPEC.EXE")) @endif
	@elseif (111 [= @option)
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSCIRRUS.EXE")) @endif
	@endif
	@cls
	@changingconfigsys2
	@if (@exists "@outdrive:\\@subdir\\cs.exe")
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CS.EXE")) @endif
	@endif
	@if (@exists "@outdrive:\\@subdir\\csalloc.exe")
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CSALLOC.EXE")) @endif
	@endif
	@if (@exists "@outdrive:\\@subdir\\atadrv.exe")
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\ATADRV.EXE")) @endif
	@endif
	@if (@exists "@indrive:\\@sourcedir\\mtddrv.exe")
	 @if (@exists "@indrive:\\@sourcedir\\mtaa.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTAA.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mtab.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTAB.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mti1.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTI1.EXE")) @endif
	 @endif
	 @cls
	 @changingconfigsys2
	 @if (@exists "@indrive:\\@sourcedir\\mti2p.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTI2P.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\mtsram.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTSRAM.EXE")) @endif
	 @endif
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MTDDRV.EXE")) @endif

	 @if (@exists "@outdrive:\\@subdir\\dblflash.exe")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
	 @endif
	 @if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
	 @elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
	       @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
	 @endif
	@cls
	@changingconfigsys2
	@elseif (@exists "@indrive:\\@sourcedir\\sramdrv.exe")
		@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SRAMDRV.EXE")) @endif    
	@elseif (@exists "@indrive:\\@sourcedir\\memdrv.exe")
		@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MEMDRV.EXE")) @endif
		@if (@exists "@outdrive:\\@subdir\\dblflash.exe")
			@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\DBLFLASH.EXE")) @endif
		@endif
		@if (@exists "@indrive:\\@sourcedir\\ssmsflsh.sys")
			@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\SSMSFLSH.SYS")) @endif
		@elseif (@exists "@indrive:\\@sourcedir\\ms-flash.sys")
			@if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\MS-FLASH.SYS")) @endif
		@endif
	@endif
	@cls
	@changingconfigsys2
	@if (@exists "@outdrive:\\@subdir\\cardid.exe")
	 @if (@spawn ("sysedit -a config.sys @dev=@outdrive:\\@subdir\\CARDID.EXE")) @endif
	@endif
	@if (@spawn ("sysedit -d config.sys REMSSMARKER")) @endif
  @enddisplay
@endif

//  ADD LIBRARY ENTRIES TO END OF CARDID.INI FILE

@display
        @if (@exists ("@outdrive:\\@subdir\\cardid.ini"))
                @cls
                @changingini
                @if (@exists ("@outdrive:\\@subdir\\sundisk5.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini SUNDISK5.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=SUNDISK5.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\intellan.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini INTELLAN.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=INTELLAN.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\dlink.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini DLINK.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=DLINK.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (@exists ("@outdrive:\\@subdir\\linksys.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini LINKSYS.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=LINKSYS.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\linksys2.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini LINKSYS2.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=LINKSYS2.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\socketea.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini SOCKETEA.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=SOCKETEA.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (@exists ("@outdrive:\\@subdir\\ibmlan.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBMLAN.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBMLAN.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\ibmtok.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBMTOK.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBMTOK.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\ibm3270.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini IBM3270.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=IBM3270.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (@exists ("@outdrive:\\@subdir\\proxim.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini PROXIM.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=PROXIM.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\cbdas.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini CBDAS.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=CBDAS.CLB")) @endif
                        @endif
                @endif
                @cls
                @changingini
                @if (@exists ("@outdrive:\\@subdir\\genmodem.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini GENMODEM.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=GENMODEM.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\genata.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini GENATA.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=GENATA.CLB")) @endif
                        @endif
                @endif
                @if (@exists ("@outdrive:\\@subdir\\wd.clb"))
                        @if (!(@spawn ("sysedit -t @outdrive:\\@subdir\\cardid.ini WD.CLB")))
                        @if (@spawn ("sysedit -a @outdrive:\\@subdir\\cardid.ini CardLib=WD.CLB")) @endif
                        @endif
                @endif
	@if (@spawn ("sysedit -d @outdrive:\\@subdir\\cardid.ini REMSSMARKER")) @endif
        @endif
@enddisplay


/*
 * ------------------ CONFIGURE SPECIAL DRIVER PARAMETERS ----------------
 *
 *      - This section will BAP many paramters, such as Number Of Sockets,
 *        for the CardSoft drivers.  This will also recognize that the Card
 *        Status Change IRQ value must be set to A(h) for the Databook 
 *        platforms.
 */

FINISH:

@chdir ("\\")
@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")

@display

@cls
@cnfgmessage

@if (@exists "ss365sl.exe")
    @if (@spawn ("card_bap ss365sl.exe /SKT @sockets") != 0)
	@cls
	@warning: @ss365sl
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ss365sl.exe /ADA 0")) @endif
    @endif

@elseif (@exists "sscirrus.exe")
    @if (@spawn ("card_bap sscirrus.exe /SKT @sockets") != 0)
	@cls
	@warning: @sscirrus
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap sscirrus.exe /ADA 0")) @endif
    @endif

@elseif (@exists "ssvadem.exe")
    @if (@spawn ("card_bap ssvadem.exe /SKT @sockets") != 0)
	@cls
	@warning: @ssvadem
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ssvadem.exe /ADA 0")) @endif
   @endif

@elseif (@exists "ssvlsi.exe")
    @if (@spawn ("card_bap ssvlsi.exe /SKT @sockets") != 0)
	@cls
	@warning: @ssvlsi
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ssvlsi.exe /ADA 0")) @endif
    @endif

@elseif (@exists "ss365lp.exe")
    @if (@spawn ("card_bap ss365lp.exe /SKT @sockets") != 0)
	@cls
	@warning: @ss365lp
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ss365lp.exe /ADA 0")) @endif
    @endif

@elseif (@exists "ssibm720.exe")
    @if (@spawn ("card_bap ssibm720.exe /SKT @sockets") != 0)
	@cls
	@warning: @ssibm720
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ssibm720.exe /ADA 0")) @endif
    @endif

@elseif (@exists "ss6941.exe")
    @if (@spawn ("card_bap ss6941.exe /SKT @sockets") != 0)
	@cls
	@warning: @ss6941
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ss6941.exe /ADA 0")) @endif
    @endif

@elseif (@exists "ss6942.exe")
    @if (@spawn ("card_bap ss6942.exe /SKT @sockets") != 0)
	@cls
	@warning: @ss6942
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
    @if (32 [= @option)
	@if (@spawn ("card_bap ss6942.exe /ADA 0")) @endif
    @endif

@endif

@cls
@cnfgmessage

@if (@exists "ssdbook.exe")
   @if (11 [= @option || 12 [= @option)
      @if (@spawn ("card_bap ssdbook.exe /SKT @sockets") !=0)
	@cls
	@warning: @ssdatabook
	@nocnfgparm /SKT
	@cargrtn
	@pause
	@cls
	@cnfgmessage
      @endif
   @endif
   @if (32 [= @option)
	@if (@spawn ("card_bap ssdbook.exe /ADA 0")) @endif
   @endif
   @if (@exists "cs.exe")
	@if (@spawn ("card_bap cs.exe /IRQ A") != 0)
	    @cls
	    @warning: @socketservices
	    @nocnfgparm /IRQ
	    @cargrtn
	    @pause
	    @cls
	    @cnfgmessage
	@endif
   @endif
   @if (576 [= @option)
	@if (@spawn ("card_bap ssdbook.exe /PORT 240") != 0)
	    @cls
	    @warning: @ssdatabook
	    @nocnfgparm /PORT
	    @cargrtn
	    @pause
	    @cls
	    @cnfgmessage
	@endif
   @elseif (704 [= @option)
	@if (@spawn ("card_bap ssdbook.exe /PORT 2C0") != 0)
	    @cls
	    @warning: @ssdatabook
	    @nocnfgparm /PORT
	    @cargrtn
	    @pause
	    @cls
	    @cnfgmessage
	@endif
   @endif        
@endif

@cls
@cnfgmessage

@if (@exists "atadrv.exe")
    @if (@spawn ("card_bap atadrv.exe /UNITS @sockets") != 0)
	@cls
	@warning: @atadrv
	@nocnfgparm /UNITS
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
@endif

@if (@exists "sramdrv.exe")
    @if (@spawn ("card_bap sramdrv.exe /MAX @sockets") != 0)
	@cls
	@warning: @sramdrv
	@nocnfgparm /MAX
	@cargrtn
	@pause
	@cls
	@cnfgmessage
    @endif
@endif

/*
 *    @if ((2 [= @option) && (300 [= @option) && (407 [= @option))
 *      @if (@spawn ("card_bap atadrv.exe /SLAVE 1") != 0)
 *              @cls
 *              @warning: @atadrv
 *              @nocnfgparm /SLAVE
 *              @cargrtn
 *              @pause
 *              @cls
 *              @cnfgmessage
 *      @endif
 *   @endif
 *   @if (@exists "@indrive:\\@sourcedir\\atadrv.exe")
 *    @if (@exists "@indrive:\\@sourcedir\\mtddrv.exe")
 *     @if (1 [= @option)
 *      @if (@spawn ("card_bap atadrv.exe /SLAVE 1") != 0)
 *              @cls
 *              @warning: @atadrv
 *              @nocnfgparm /SLAVE
 *              @cargrtn
 *              @pause
 *              @cls
 *              @cnfgmessage
 *      @endif
 *     @endif
 *    @endif
 *   @endif
 */

@if (40 [= @option)
   @if (@exists "cs.exe")
	@if (@spawn ("card_bap cs.exe /IRQ A") != 0)
	    @cls
	    @warning: @socketservices
	    @nocnfgparm /IRQ
	    @cargrtn
	    @pause
	    @cls
	    @cnfgmessage
	@endif
   @endif
@endif

@enddisplay

/*
 * ---------------- CHECK FOR MEMORY MANAGER -----------------------------
 *
 *      - This section will search the config.sys located on the root for 
 *        the presence of either the EMM386, the QEMM, or the 386MAX memory
 *        manager. If one of the above is found, instructions will be 
 *        displayed for the user on which swtiches to add to the device line.
 */

@chdir ("\\")
@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")

@display
  @memmansearch
  @if (@spawn ("sysedit -t @outdrive:\\config.sys EMM386.EXE"))
	@cls
	@foundemm

	DEVICE=@outdrive:\@dossubdir\EMM386.EXE NOEMS X=D000-DFFF

	@pause
  @elseif (@spawn ("sysedit -t @outdrive:\\config.sys QEMM.EXE"))
	@cls
	@foundqemm

	DEVICE=@outdrive:\@dossubdir\QEMM.EXE X=D000-DFFF

	@pause
  @elseif (@spawn ("sysedit -t @outdrive:\\config.sys 386MAX"))
	@cls
	@foundmax

	DEVICE=@outdrive:\@dossubdir\386MAX.SYS RAM=D000-DFFF

	@pause
  @endif
@enddisplay

/*
 * ---------------------------------------------------------------------
 * ------------------------ FINISH / CONCLUSION ------------------------
 *
 *      - The finish block will execute if it exists, CSALLOC.  Some
 *        helpful messages will be given to the user also.
 */


CONCLUSION:

@chdrive (@outdrive)
@chdir ("\\")
@chdir ("@subdir")


//      MAKE ALL CLB FILES READ-ONLY SO TO AVOID ACCIDENTAL DELETION

@if ((@exists "sundisk5.clb")    || 
        (@exists "intellan.clb") || 
        (@exists "dlink.clb")    || 
        (@exists "linksys.clb")  || 
        (@exists "linksys2.clb") || 
        (@exists "socketea.clb") || 
        (@exists "ibmlan.clb")   || 
        (@exists "ibmtok.clb")   || 
        (@exists "ibm3270.clb")  || 
        (@exists "wd.clb")       || 
        (@exists "proxim.clb")   || 
        (@exists "cbdas.clb")    || 
        (@exists "xircom.clb")   || 
        (@exists "tdklan2.clb")  || 
        (@exists "genmodem.clb") || 
        (@exists "genata.clb"))
        @if (@spawn ("attrib +R *.clb")) @endif
@endif

@delete ("ssdetect.exe")
@delete ("csdetect.exe")
@delete ("adapter.exe")
@delete ("card_bap.exe")
@delete ("sysedit.exe")

@display
	@cls
	@if (@exists("@outdrive:\\@subdir\\config.exe")) 
	  @runcnfgmess@subdir@runcnfgmess2
	  @runcnfgmess3
	  @pause 
	  @cls 
	  @endif
	@if (@exists("@outdrive:\\@subdir\\csalloc.exe")) 
	  @cls
	  @runcsallocmess2 
	  @pause
	  @if (@spawn ("@outdrive:\\@subdir\\csalloc /d /q")) @endif
	  @csallocdone
	  @pause 
	  @cls    
	@endif
@enddisplay

BOTTOM:

@getoption
    @cls
    @nextoption1
    @if (@exists("@indrive:\\setup.exe")) @nextoption2 @endif
    @localwindow (16,38)
    @option 22 = "@noboot"
@endoption

@finish
	/* exit to DOS */
@endfinish

